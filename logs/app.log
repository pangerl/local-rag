2025-07-27 19:36:22 - local_rag - INFO - logging_config.py:88 - setup_logging - 日志系统初始化完成
2025-07-27 19:36:22 - local_rag - INFO - <string>:1 - <module> - 测试日志系统
2025-07-27 19:36:49 - local_rag - INFO - logging_config.py:88 - setup_logging - 日志系统初始化完成
2025-07-27 19:36:49 - local_rag - INFO - main.py:21 - main - Local RAG 系统启动中...
2025-07-27 19:36:49 - local_rag - INFO - main.py:24 - main - 模型基础路径: models
2025-07-27 19:36:49 - local_rag - INFO - main.py:25 - main - 嵌入模型路径: models/bge-small-zh-v1.5
2025-07-27 19:36:49 - local_rag - INFO - main.py:26 - main - 重排序模型路径: models/bge-reranker-base
2025-07-27 19:36:49 - local_rag - INFO - main.py:27 - main - ChromaDB 路径: data/chroma_db
2025-07-27 19:36:49 - local_rag - INFO - main.py:31 - main - 路径验证结果: {'embedding_model': True, 'reranker_model': True, 'chroma_db_dir': True, 'log_dir': True}
2025-07-27 19:36:49 - local_rag - INFO - main.py:37 - main - Local RAG 系统基础配置完成
2025-07-27 22:34:59 - local_rag - INFO - logging_config.py:88 - setup_logging - 日志系统初始化完成
2025-07-27 22:35:47 - local_rag - INFO - logging_config.py:88 - setup_logging - 日志系统初始化完成
2025-07-27 22:36:46 - local_rag - INFO - logging_config.py:88 - setup_logging - 日志系统初始化完成
2025-07-27 22:37:02 - local_rag - INFO - logging_config.py:88 - setup_logging - 日志系统初始化完成
2025-07-27 22:37:02 - local_rag - INFO - main.py:85 - lifespan - ==================================================
2025-07-27 22:37:02 - local_rag - INFO - main.py:86 - lifespan - Local RAG 系统启动中...
2025-07-27 22:37:02 - local_rag - INFO - main.py:87 - lifespan - ==================================================
2025-07-27 22:37:02 - local_rag - INFO - main.py:39 - _validate_environment - 验证运行环境...
2025-07-27 22:37:02 - local_rag - INFO - main.py:47 - _validate_environment - 路径验证结果: {'embedding_model': True, 'reranker_model': True, 'chroma_db_dir': True, 'log_dir': True}
2025-07-27 22:37:02 - local_rag - INFO - main.py:62 - _validate_environment - 必要目录创建完成
2025-07-27 22:37:02 - local_rag - INFO - main.py:97 - lifespan - API 服务地址: http://0.0.0.0:8000
2025-07-27 22:37:02 - local_rag - INFO - main.py:98 - lifespan - 嵌入模型路径: models/bge-small-zh-v1.5
2025-07-27 22:37:02 - local_rag - INFO - main.py:99 - lifespan - 重排序模型路径: models/bge-reranker-base
2025-07-27 22:37:02 - local_rag - INFO - main.py:100 - lifespan - ChromaDB 路径: data/chroma_db
2025-07-27 22:37:02 - local_rag - INFO - main.py:101 - lifespan - 日志级别: INFO
2025-07-27 22:37:02 - local_rag - INFO - main.py:104 - lifespan - 初始化服务组件...
2025-07-27 22:37:02 - app.services.database - INFO - database.py:39 - __init__ - ChromaDB 服务初始化，数据库路径: data/chroma_db
2025-07-27 22:37:02 - app.services.model_loader - INFO - model_loader.py:39 - __init__ - 模型加载器初始化完成，嵌入模型路径: models/bge-small-zh-v1.5
2025-07-27 22:37:02 - app.services.model_loader - INFO - model_loader.py:40 - __init__ - 重排序模型路径: models/bge-reranker-base
2025-07-27 22:37:02 - app.core.document_processor - INFO - document_processor.py:30 - __init__ - DocumentProcessor 初始化完成
2025-07-27 22:37:02 - app.core.chunker - INFO - chunker.py:27 - __init__ - JiebaChunker 初始化完成
2025-07-27 22:37:02 - app.services.vector_store - INFO - vector_store.py:43 - __init__ - 向量存储服务初始化完成
2025-07-27 22:37:02 - app.services.document_service - INFO - document_service.py:65 - __init__ - 文档处理服务初始化完成
2025-07-27 22:37:02 - app.services.retriever - INFO - retriever.py:57 - __init__ - 向量检索器初始化完成
2025-07-27 22:37:02 - app.api.routes - INFO - routes.py:77 - init_services - API 服务初始化完成
2025-07-27 22:37:02 - local_rag - INFO - main.py:110 - lifespan - ==================================================
2025-07-27 22:37:02 - local_rag - INFO - main.py:111 - lifespan - Local RAG 系统启动完成！
2025-07-27 22:37:02 - local_rag - INFO - main.py:112 - lifespan - API 文档地址: http://0.0.0.0:8000/docs
2025-07-27 22:37:02 - local_rag - INFO - main.py:113 - lifespan - ==================================================
2025-07-27 22:37:02 - local_rag - INFO - main.py:133 - lifespan - ==================================================
2025-07-27 22:37:02 - local_rag - INFO - main.py:134 - lifespan - Local RAG 系统关闭中...
2025-07-27 22:37:02 - local_rag - INFO - main.py:135 - lifespan - ==================================================
2025-07-27 22:37:02 - local_rag - INFO - main.py:139 - lifespan - 执行清理操作...
2025-07-27 22:37:02 - local_rag - INFO - main.py:144 - lifespan - 清理操作完成
2025-07-27 22:37:02 - local_rag - INFO - main.py:149 - lifespan - Local RAG 系统已关闭
2025-07-27 22:37:02 - local_rag - INFO - main.py:150 - lifespan - ==================================================
2025-07-27 22:37:40 - local_rag - INFO - logging_config.py:88 - setup_logging - 日志系统初始化完成
2025-07-27 22:37:40 - local_rag - INFO - main.py:368 - run_server - 启动 FastAPI 服务器: 0.0.0.0:8000
2025-07-27 22:37:41 - local_rag - INFO - main.py:85 - lifespan - ==================================================
2025-07-27 22:37:41 - local_rag - INFO - main.py:86 - lifespan - Local RAG 系统启动中...
2025-07-27 22:37:41 - local_rag - INFO - main.py:87 - lifespan - ==================================================
2025-07-27 22:37:41 - local_rag - INFO - main.py:39 - _validate_environment - 验证运行环境...
2025-07-27 22:37:41 - local_rag - INFO - main.py:47 - _validate_environment - 路径验证结果: {'embedding_model': True, 'reranker_model': True, 'chroma_db_dir': True, 'log_dir': True}
2025-07-27 22:37:41 - local_rag - INFO - main.py:62 - _validate_environment - 必要目录创建完成
2025-07-27 22:37:41 - local_rag - ERROR - main.py:128 - lifespan - 系统启动失败: signal only works in main thread of the main interpreter
Traceback (most recent call last):
  File "/Users/lanpang/data/code/local-rag/app/main.py", line 94, in lifespan
    _setup_signal_handlers()
    ~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/lanpang/data/code/local-rag/app/main.py", line 75, in _setup_signal_handlers
    signal.signal(signal.SIGINT, signal_handler)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.4/Frameworks/Python.framework/Versions/3.13/lib/python3.13/signal.py", line 58, in signal
    handler = _signal.signal(_enum_to_int(signalnum), _enum_to_int(handler))
ValueError: signal only works in main thread of the main interpreter
2025-07-27 22:37:41 - local_rag - INFO - main.py:133 - lifespan - ==================================================
2025-07-27 22:37:41 - local_rag - INFO - main.py:134 - lifespan - Local RAG 系统关闭中...
2025-07-27 22:37:41 - local_rag - INFO - main.py:135 - lifespan - ==================================================
2025-07-27 22:37:41 - local_rag - INFO - main.py:139 - lifespan - 执行清理操作...
2025-07-27 22:37:41 - local_rag - INFO - main.py:144 - lifespan - 清理操作完成
2025-07-27 22:37:41 - local_rag - INFO - main.py:149 - lifespan - Local RAG 系统已关闭
2025-07-27 22:37:41 - local_rag - INFO - main.py:150 - lifespan - ==================================================
2025-07-27 22:38:14 - local_rag - INFO - logging_config.py:88 - setup_logging - 日志系统初始化完成
2025-07-27 22:38:14 - local_rag - INFO - main.py:93 - lifespan - ==================================================
2025-07-27 22:38:14 - local_rag - INFO - main.py:94 - lifespan - Local RAG 系统启动中...
2025-07-27 22:38:14 - local_rag - INFO - main.py:95 - lifespan - ==================================================
2025-07-27 22:38:14 - local_rag - INFO - main.py:39 - _validate_environment - 验证运行环境...
2025-07-27 22:38:14 - local_rag - INFO - main.py:47 - _validate_environment - 路径验证结果: {'embedding_model': True, 'reranker_model': True, 'chroma_db_dir': True, 'log_dir': True}
2025-07-27 22:38:14 - local_rag - INFO - main.py:62 - _validate_environment - 必要目录创建完成
2025-07-27 22:38:14 - local_rag - INFO - main.py:78 - _setup_signal_handlers - 信号处理器设置完成
2025-07-27 22:38:14 - local_rag - INFO - main.py:105 - lifespan - API 服务地址: http://0.0.0.0:8000
2025-07-27 22:38:14 - local_rag - INFO - main.py:106 - lifespan - 嵌入模型路径: models/bge-small-zh-v1.5
2025-07-27 22:38:14 - local_rag - INFO - main.py:107 - lifespan - 重排序模型路径: models/bge-reranker-base
2025-07-27 22:38:14 - local_rag - INFO - main.py:108 - lifespan - ChromaDB 路径: data/chroma_db
2025-07-27 22:38:14 - local_rag - INFO - main.py:109 - lifespan - 日志级别: INFO
2025-07-27 22:38:14 - local_rag - INFO - main.py:112 - lifespan - 初始化服务组件...
2025-07-27 22:38:14 - app.services.database - INFO - database.py:39 - __init__ - ChromaDB 服务初始化，数据库路径: data/chroma_db
2025-07-27 22:38:14 - app.services.model_loader - INFO - model_loader.py:39 - __init__ - 模型加载器初始化完成，嵌入模型路径: models/bge-small-zh-v1.5
2025-07-27 22:38:14 - app.services.model_loader - INFO - model_loader.py:40 - __init__ - 重排序模型路径: models/bge-reranker-base
2025-07-27 22:38:14 - app.core.document_processor - INFO - document_processor.py:30 - __init__ - DocumentProcessor 初始化完成
2025-07-27 22:38:14 - app.core.chunker - INFO - chunker.py:27 - __init__ - JiebaChunker 初始化完成
2025-07-27 22:38:14 - app.services.vector_store - INFO - vector_store.py:43 - __init__ - 向量存储服务初始化完成
2025-07-27 22:38:14 - app.services.document_service - INFO - document_service.py:65 - __init__ - 文档处理服务初始化完成
2025-07-27 22:38:14 - app.services.retriever - INFO - retriever.py:57 - __init__ - 向量检索器初始化完成
2025-07-27 22:38:14 - app.api.routes - INFO - routes.py:77 - init_services - API 服务初始化完成
2025-07-27 22:38:14 - local_rag - INFO - main.py:118 - lifespan - ==================================================
2025-07-27 22:38:14 - local_rag - INFO - main.py:119 - lifespan - Local RAG 系统启动完成！
2025-07-27 22:38:14 - local_rag - INFO - main.py:120 - lifespan - API 文档地址: http://0.0.0.0:8000/docs
2025-07-27 22:38:14 - local_rag - INFO - main.py:121 - lifespan - ==================================================
2025-07-27 22:38:14 - local_rag - INFO - main.py:141 - lifespan - ==================================================
2025-07-27 22:38:14 - local_rag - INFO - main.py:142 - lifespan - Local RAG 系统关闭中...
2025-07-27 22:38:14 - local_rag - INFO - main.py:143 - lifespan - ==================================================
2025-07-27 22:38:14 - local_rag - INFO - main.py:147 - lifespan - 执行清理操作...
2025-07-27 22:38:14 - local_rag - INFO - main.py:152 - lifespan - 清理操作完成
2025-07-27 22:38:14 - local_rag - INFO - main.py:157 - lifespan - Local RAG 系统已关闭
2025-07-27 22:38:14 - local_rag - INFO - main.py:158 - lifespan - ==================================================
2025-07-27 22:44:06 - local_rag - INFO - logging_config.py:88 - setup_logging - 日志系统初始化完成
2025-07-27 22:44:06 - local_rag - INFO - main.py:95 - lifespan - ==================================================
2025-07-27 22:44:06 - local_rag - INFO - main.py:96 - lifespan - Local RAG 系统启动中...
2025-07-27 22:44:06 - local_rag - INFO - main.py:97 - lifespan - ==================================================
2025-07-27 22:44:06 - local_rag - INFO - main.py:41 - _validate_environment - 验证运行环境...
2025-07-27 22:44:06 - local_rag - INFO - main.py:49 - _validate_environment - 路径验证结果: {'embedding_model': True, 'reranker_model': True, 'chroma_db_dir': True, 'log_dir': True}
2025-07-27 22:44:06 - local_rag - INFO - main.py:64 - _validate_environment - 必要目录创建完成
2025-07-27 22:44:06 - local_rag - INFO - main.py:80 - _setup_signal_handlers - 信号处理器设置完成
2025-07-27 22:44:06 - local_rag - INFO - main.py:107 - lifespan - API 服务地址: http://0.0.0.0:8000
2025-07-27 22:44:06 - local_rag - INFO - main.py:108 - lifespan - 嵌入模型路径: models/bge-small-zh-v1.5
2025-07-27 22:44:06 - local_rag - INFO - main.py:109 - lifespan - 重排序模型路径: models/bge-reranker-base
2025-07-27 22:44:06 - local_rag - INFO - main.py:110 - lifespan - ChromaDB 路径: data/chroma_db
2025-07-27 22:44:06 - local_rag - INFO - main.py:111 - lifespan - 日志级别: INFO
2025-07-27 22:44:06 - local_rag - INFO - main.py:114 - lifespan - 初始化服务组件...
2025-07-27 22:44:06 - app.services.database - INFO - database.py:39 - __init__ - ChromaDB 服务初始化，数据库路径: data/chroma_db
2025-07-27 22:44:06 - app.services.model_loader - INFO - model_loader.py:39 - __init__ - 模型加载器初始化完成，嵌入模型路径: models/bge-small-zh-v1.5
2025-07-27 22:44:06 - app.services.model_loader - INFO - model_loader.py:40 - __init__ - 重排序模型路径: models/bge-reranker-base
2025-07-27 22:44:06 - app.core.document_processor - INFO - document_processor.py:30 - __init__ - DocumentProcessor 初始化完成
2025-07-27 22:44:06 - app.core.chunker - INFO - chunker.py:27 - __init__ - JiebaChunker 初始化完成
2025-07-27 22:44:06 - app.services.vector_store - INFO - vector_store.py:43 - __init__ - 向量存储服务初始化完成
2025-07-27 22:44:06 - app.services.document_service - INFO - document_service.py:65 - __init__ - 文档处理服务初始化完成
2025-07-27 22:44:06 - app.services.retriever - INFO - retriever.py:57 - __init__ - 向量检索器初始化完成
2025-07-27 22:44:06 - app.api.routes - INFO - routes.py:77 - init_services - API 服务初始化完成
2025-07-27 22:44:06 - local_rag - INFO - main.py:120 - lifespan - ==================================================
2025-07-27 22:44:06 - local_rag - INFO - main.py:121 - lifespan - Local RAG 系统启动完成！
2025-07-27 22:44:06 - local_rag - INFO - main.py:122 - lifespan - API 文档地址: http://0.0.0.0:8000/docs
2025-07-27 22:44:06 - local_rag - INFO - main.py:123 - lifespan - ==================================================
2025-07-27 22:44:06 - local_rag - INFO - main.py:143 - lifespan - ==================================================
2025-07-27 22:44:06 - local_rag - INFO - main.py:144 - lifespan - Local RAG 系统关闭中...
2025-07-27 22:44:06 - local_rag - INFO - main.py:145 - lifespan - ==================================================
2025-07-27 22:44:06 - local_rag - INFO - main.py:149 - lifespan - 执行清理操作...
2025-07-27 22:44:06 - local_rag - INFO - main.py:154 - lifespan - 清理操作完成
2025-07-27 22:44:06 - local_rag - INFO - main.py:159 - lifespan - Local RAG 系统已关闭
2025-07-27 22:44:06 - local_rag - INFO - main.py:160 - lifespan - ==================================================
2025-07-27 22:55:45 - local_rag - INFO - logging_config.py:232 - setup_logging - 增强日志系统初始化完成
2025-07-27 22:55:45 - local_rag - INFO - main.py:97 - lifespan - ==================================================
2025-07-27 22:55:45 - local_rag - INFO - main.py:98 - lifespan - Local RAG 系统启动中...
2025-07-27 22:55:45 - local_rag - INFO - main.py:99 - lifespan - ==================================================
2025-07-27 22:55:45 - local_rag - INFO - main.py:43 - _validate_environment - 验证运行环境...
2025-07-27 22:55:45 - local_rag - INFO - main.py:51 - _validate_environment - 路径验证结果: {'embedding_model': True, 'reranker_model': True, 'chroma_db_dir': True, 'log_dir': True}
2025-07-27 22:55:45 - local_rag - INFO - main.py:66 - _validate_environment - 必要目录创建完成
2025-07-27 22:55:45 - local_rag - INFO - main.py:82 - _setup_signal_handlers - 信号处理器设置完成
2025-07-27 22:55:45 - local_rag - INFO - main.py:109 - lifespan - API 服务地址: http://0.0.0.0:8000
2025-07-27 22:55:45 - local_rag - INFO - main.py:110 - lifespan - 嵌入模型路径: models/bge-small-zh-v1.5
2025-07-27 22:55:45 - local_rag - INFO - main.py:111 - lifespan - 重排序模型路径: models/bge-reranker-base
2025-07-27 22:55:45 - local_rag - INFO - main.py:112 - lifespan - ChromaDB 路径: data/chroma_db
2025-07-27 22:55:45 - local_rag - INFO - main.py:113 - lifespan - 日志级别: INFO
2025-07-27 22:55:45 - local_rag - INFO - main.py:116 - lifespan - 初始化服务组件...
2025-07-27 22:55:45 - app.services.database - INFO - database.py:39 - __init__ - ChromaDB 服务初始化，数据库路径: data/chroma_db
2025-07-27 22:55:45 - app.services.model_loader - INFO - model_loader.py:39 - __init__ - 模型加载器初始化完成，嵌入模型路径: models/bge-small-zh-v1.5
2025-07-27 22:55:45 - app.services.model_loader - INFO - model_loader.py:40 - __init__ - 重排序模型路径: models/bge-reranker-base
2025-07-27 22:55:45 - app.core.document_processor - INFO - document_processor.py:30 - __init__ - DocumentProcessor 初始化完成
2025-07-27 22:55:45 - app.core.chunker - INFO - chunker.py:27 - __init__ - JiebaChunker 初始化完成
2025-07-27 22:55:45 - app.services.vector_store - INFO - vector_store.py:43 - __init__ - 向量存储服务初始化完成
2025-07-27 22:55:45 - app.services.document_service - INFO - document_service.py:65 - __init__ - 文档处理服务初始化完成
2025-07-27 22:55:45 - app.services.retriever - INFO - retriever.py:57 - __init__ - 向量检索器初始化完成
2025-07-27 22:55:45 - app.api.routes - INFO - routes.py:77 - init_services - API 服务初始化完成
2025-07-27 22:55:45 - local_rag - INFO - main.py:120 - lifespan - 启动系统监控...
2025-07-27 22:55:45 - app.core.monitoring - INFO - monitoring.py:255 - start_monitoring - 系统监控已启动，监控间隔: 30秒
2025-07-27 22:55:45 - local_rag - INFO - main.py:126 - lifespan - ==================================================
2025-07-27 22:55:45 - local_rag - INFO - main.py:127 - lifespan - Local RAG 系统启动完成！
2025-07-27 22:55:45 - local_rag - INFO - main.py:128 - lifespan - API 文档地址: http://0.0.0.0:8000/docs
2025-07-27 22:55:45 - local_rag - INFO - main.py:129 - lifespan - ==================================================
2025-07-27 22:55:47 - local_rag - INFO - main.py:149 - lifespan - ==================================================
2025-07-27 22:55:47 - local_rag - INFO - main.py:150 - lifespan - Local RAG 系统关闭中...
2025-07-27 22:55:47 - local_rag - INFO - main.py:151 - lifespan - ==================================================
2025-07-27 22:55:47 - local_rag - INFO - main.py:155 - lifespan - 执行清理操作...
2025-07-27 22:55:47 - local_rag - INFO - main.py:158 - lifespan - 停止系统监控...
2025-07-27 22:55:52 - app.core.monitoring - INFO - monitoring.py:263 - stop_monitoring - 系统监控已停止
2025-07-27 22:55:52 - local_rag - INFO - main.py:164 - lifespan - 清理操作完成
2025-07-27 22:55:52 - local_rag - INFO - main.py:169 - lifespan - Local RAG 系统已关闭
2025-07-27 22:55:52 - local_rag - INFO - main.py:170 - lifespan - ==================================================
2025-07-27 22:56:17 - local_rag - INFO - logging_config.py:232 - setup_logging - 增强日志系统初始化完成
2025-07-27 22:56:17 - app.middleware.request_tracker - INFO - request_tracker.py:32 - __init__ - 请求追踪中间件初始化完成
2025-07-27 22:56:17 - httpx - INFO - _client.py:1025 - _send_single_request - HTTP Request: GET http://testserver/api/v1/monitoring/metrics?time_window=300 "HTTP/1.1 503 Service Unavailable"
2025-07-27 22:56:41 - local_rag - INFO - logging_config.py:232 - setup_logging - 增强日志系统初始化完成
2025-07-27 22:56:41 - app.middleware.request_tracker - INFO - request_tracker.py:32 - __init__ - 请求追踪中间件初始化完成
2025-07-27 22:56:41 - app.middleware.request_tracker - INFO - request_tracker.py:62 - dispatch - [c69ba114] 请求开始: GET /api/v1/monitoring/metrics 来自 testclient
2025-07-27 22:56:41 - app.api.monitoring - INFO - monitoring.py:64 - get_metrics_summary - 获取指标摘要，时间窗口: 300秒
2025-07-27 22:56:41 - app.api.monitoring - ERROR - monitoring.py:71 - get_metrics_summary - 获取指标摘要失败: 4 validation errors for MetricsSummaryResponse
status_codes
  Field required [type=missing, input_value={'time_window': 300, 'req...requests_per_second': 0}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
endpoints
  Field required [type=missing, input_value={'time_window': 300, 'req...requests_per_second': 0}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
counters
  Field required [type=missing, input_value={'time_window': 300, 'req...requests_per_second': 0}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
gauges
  Field required [type=missing, input_value={'time_window': 300, 'req...requests_per_second': 0}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
Traceback (most recent call last):
  File "/Users/lanpang/data/code/local-rag/app/api/monitoring.py", line 68, in get_metrics_summary
    return MetricsSummaryResponse(**summary)
  File "/Users/lanpang/data/code/local-rag/.venv/lib/python3.13/site-packages/pydantic/main.py", line 253, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
pydantic_core._pydantic_core.ValidationError: 4 validation errors for MetricsSummaryResponse
status_codes
  Field required [type=missing, input_value={'time_window': 300, 'req...requests_per_second': 0}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
endpoints
  Field required [type=missing, input_value={'time_window': 300, 'req...requests_per_second': 0}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
counters
  Field required [type=missing, input_value={'time_window': 300, 'req...requests_per_second': 0}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
gauges
  Field required [type=missing, input_value={'time_window': 300, 'req...requests_per_second': 0}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-07-27 22:56:41 - app.middleware.exception_handler - ERROR - exception_handler.py:195 - _log_exception - [testclient] GET /api/v1/monitoring/metrics - 异常: HTTPException: 500: 获取指标摘要失败: 4 validation errors for MetricsSummaryResponse
status_codes
  Field required [type=missing, input_value={'time_window': 300, 'req...requests_per_second': 0}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
endpoints
  Field required [type=missing, input_value={'time_window': 300, 'req...requests_per_second': 0}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
counters
  Field required [type=missing, input_value={'time_window': 300, 'req...requests_per_second': 0}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
gauges
  Field required [type=missing, input_value={'time_window': 300, 'req...requests_per_second': 0}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing - 状态码: 500
Traceback (most recent call last):
  File "/Users/lanpang/data/code/local-rag/app/api/monitoring.py", line 68, in get_metrics_summary
    return MetricsSummaryResponse(**summary)
  File "/Users/lanpang/data/code/local-rag/.venv/lib/python3.13/site-packages/pydantic/main.py", line 253, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
pydantic_core._pydantic_core.ValidationError: 4 validation errors for MetricsSummaryResponse
status_codes
  Field required [type=missing, input_value={'time_window': 300, 'req...requests_per_second': 0}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
endpoints
  Field required [type=missing, input_value={'time_window': 300, 'req...requests_per_second': 0}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
counters
  Field required [type=missing, input_value={'time_window': 300, 'req...requests_per_second': 0}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
gauges
  Field required [type=missing, input_value={'time_window': 300, 'req...requests_per_second': 0}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/lanpang/data/code/local-rag/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/lanpang/data/code/local-rag/.venv/lib/python3.13/site-packages/starlette/routing.py", line 75, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/lanpang/data/code/local-rag/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 302, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/lanpang/data/code/local-rag/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 213, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lanpang/data/code/local-rag/app/api/monitoring.py", line 72, in get_metrics_summary
    raise HTTPException(
    ...<2 lines>...
    )
fastapi.exceptions.HTTPException: 500: 获取指标摘要失败: 4 validation errors for MetricsSummaryResponse
status_codes
  Field required [type=missing, input_value={'time_window': 300, 'req...requests_per_second': 0}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
endpoints
  Field required [type=missing, input_value={'time_window': 300, 'req...requests_per_second': 0}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
counters
  Field required [type=missing, input_value={'time_window': 300, 'req...requests_per_second': 0}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
gauges
  Field required [type=missing, input_value={'time_window': 300, 'req...requests_per_second': 0}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-07-27 22:56:41 - app.middleware.request_tracker - INFO - request_tracker.py:126 - dispatch - [c69ba114] 请求完成: GET /api/v1/monitoring/metrics - 状态码: 500 ❌ - 耗时: 0.007s
2025-07-27 22:56:41 - httpx - INFO - _client.py:1025 - _send_single_request - HTTP Request: GET http://testserver/api/v1/monitoring/metrics?time_window=300 "HTTP/1.1 500 Internal Server Error"
2025-07-27 22:57:00 - local_rag - INFO - logging_config.py:232 - setup_logging - 增强日志系统初始化完成
2025-07-27 22:57:00 - app.middleware.request_tracker - INFO - request_tracker.py:32 - __init__ - 请求追踪中间件初始化完成
2025-07-27 22:57:00 - app.middleware.request_tracker - INFO - request_tracker.py:62 - dispatch - [b83f9c5d] 请求开始: GET /api/v1/monitoring/metrics 来自 testclient
2025-07-27 22:57:00 - app.api.monitoring - INFO - monitoring.py:64 - get_metrics_summary - 获取指标摘要，时间窗口: 300秒
2025-07-27 22:57:00 - app.middleware.request_tracker - INFO - request_tracker.py:126 - dispatch - [b83f9c5d] 请求完成: GET /api/v1/monitoring/metrics - 状态码: 200 ✅ - 耗时: 0.000s
2025-07-27 22:57:00 - httpx - INFO - _client.py:1025 - _send_single_request - HTTP Request: GET http://testserver/api/v1/monitoring/metrics?time_window=300 "HTTP/1.1 200 OK"
2025-07-27 22:57:00 - app.middleware.request_tracker - INFO - request_tracker.py:62 - dispatch - [71998c0a] 请求开始: GET /api/v1/monitoring/system 来自 testclient
2025-07-27 22:57:00 - app.api.monitoring - INFO - monitoring.py:92 - get_system_status - 获取系统状态
2025-07-27 22:57:00 - app.middleware.request_tracker - INFO - request_tracker.py:126 - dispatch - [71998c0a] 请求完成: GET /api/v1/monitoring/system - 状态码: 200 ✅ - 耗时: 0.106s
2025-07-27 22:57:00 - httpx - INFO - _client.py:1025 - _send_single_request - HTTP Request: GET http://testserver/api/v1/monitoring/system "HTTP/1.1 200 OK"
2025-07-27 22:57:00 - app.middleware.request_tracker - INFO - request_tracker.py:62 - dispatch - [237a72b1] 请求开始: GET /api/v1/monitoring/health/detailed 来自 testclient
2025-07-27 22:57:00 - app.api.monitoring - INFO - monitoring.py:119 - detailed_health_check - 执行详细健康检查
2025-07-27 22:57:00 - app.middleware.request_tracker - INFO - request_tracker.py:126 - dispatch - [237a72b1] 请求完成: GET /api/v1/monitoring/health/detailed - 状态码: 200 ✅ - 耗时: 0.108s
2025-07-27 22:57:00 - httpx - INFO - _client.py:1025 - _send_single_request - HTTP Request: GET http://testserver/api/v1/monitoring/health/detailed "HTTP/1.1 200 OK"
2025-07-27 22:57:00 - app.middleware.request_tracker - INFO - request_tracker.py:62 - dispatch - [553e79b0] 请求开始: GET / 来自 testclient
2025-07-27 22:57:00 - app.middleware.request_tracker - INFO - request_tracker.py:126 - dispatch - [553e79b0] 请求完成: GET / - 状态码: 200 ✅ - 耗时: 0.001s
2025-07-27 22:57:00 - httpx - INFO - _client.py:1025 - _send_single_request - HTTP Request: GET http://testserver/ "HTTP/1.1 200 OK"
